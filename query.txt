select member.nama_member, membayar.id_pembayaran, SUM(POINT) "POINT"
FROM MEMBER
JOIN MEMBELI ON MEMBELI.ID_MEMBER = MEMBER.ID_MEMBER
JOIN MEMBAYAR ON MEMBAYAR.ID_MEMBELI = MEMBELI.ID_MEMBELI
JOIN DETIL_MEMBAYAR ON DETIL_MEMBAYAR.ID_PEMBAYARAN = MEMBAYAR.ID_PEMBAYARAN
WHERE POINT >= 50
GROUP BY member.nama_member, MEMBAYAR.ID_PEMBAYARAN;

select nama_member, id_pembayaran, SUM(POINT) "POINT"
FROM MEMBER
JOIN MEMBELI USING (ID_MEMBER)
JOIN MEMBAYAR USING (ID_MEMBELI)
JOIN DETIL_MEMBAYAR USING (ID_PEMBAYARAN)
WHERE POINT >= 50
GROUP BY nama_member, ID_PEMBAYARAN;

select nama_member, jenis_kelamin, alamat, ceil((sysdate-tanggal_lahir)/365) as UMUR
From member
where ceil((sysdate-tanggal_lahir)/365)<100;

select SUPPLIER.NAMA_PENYUPLAI, SUPPLIER.KODE_PENYUPLAI, SUM(TRANSAKSI.TOTALPENGELUARAN) AS PENDAPATAN_SUPPLIER
FROM SUPPLIER, PEGAWAI, MENGAWASI, TRANSAKSI
WHERE SUPPLIER.KODE_PENYUPLAI = TRANSAKSI.KODE_PENYUPLAI
AND TRANSAKSI.ID_TRANSAKSI = MENGAWASI.ID_TRANSAKSI
AND PEGAWAI.NIP_P = MENGAWASI.NIP_P
group by SUPPLIER.NAMA_PENYUPLAI, SUPPLIER.KODE_PENYUPLAI;

select * from 
(select round(sum(mm.total_bayar)) "Total Bayar", mb.id_member "ID Member", m.nama_member
from membayar mm, membeli mb, member m
where mm.id_membeli = mb.id_membeli
and m.ID_MEMBER = mb.ID_MEMBER
group by mb.id_member, m.nama_member
order by sum(mm.total_bayar) desc
)
where rownum = 1;

select NAMA_PEGAWAI "NAMA KASIR", NIP_P, NAMA_MEMBER, TANGGAL_MEMBAYAR
FROM MEMBER 
JOIN MEMBELI USING (ID_MEMBER)
JOIN MEMBAYAR USING (ID_MEMBELI)
JOIN DETIL_MEMBAYAR USING (ID_PEMBAYARAN)
JOIN PEGAWAI USING (NIP_P);

